@startuml
skinparam backgroundcolor white

skinparam component {
  BackgroundColor White
  BorderColor Black
  ArrowColor Black
  ArrowFontColor Black
}
skinparam node {
  BackgroundColor White
  BorderColor Black
}

' Физическая машина с контейнерами
node "Виртуальная/физическая\nмашина (хост, узел)" as Host {
  package "Контейнер #1" as Container1 {
    component "Микросервис #1" as MS1 {
      component "Библиотека\nлогирования" as LogLib1
    }
    file "Локальный\nлог-файл 1" as LocalLog1
  }

  package "Контейнер #2" as Container2 {
    component "Микросервис #2" as MS2 {
      component "Библиотека\nлогирования" as LogLib2
    }
    file "Локальный\nлог-файл 2" as LocalLog2
  }

  package "Контейнер #n" as ContainerN {
    component "Агент\nлогирования" as LogAgent
  }

}

' Message Broker
package "Message broker\n(HA-кластеры)" as MessageBroker {
  queue "Топики" as Topics
}

' Платформенные сервисы
package "Платформа:\nбазовые сервисы" as Platform {
  component "Центральный\nсервис логирования" as CentralLogging
  database "Хранилище\nлогов" as LogStorage
}

' Связи
LogLib1 --> LocalLog1 : "запись"
LogLib2 --> LocalLog2 : "запись"
LogAgent --> LocalLog1 : "чтение"
LogAgent --> LocalLog2 : "чтение"
LogAgent --> Topics : "публикация"
CentralLogging --> Topics : "чтение"
CentralLogging --> LogStorage : "сохранение"

@enduml
